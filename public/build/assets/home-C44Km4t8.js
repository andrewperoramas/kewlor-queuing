import{U as S,m as O,j as e,g as R,K as U,r as D,V as E,L as A,A as J}from"./app-RN_dJLB9.js";import{B as I}from"./button-B7dxIvyb.js";import{L as N,I as q,a as v}from"./label-PyyQLjWT.js";import{L as _}from"./loader-circle-QDDGTkna.js";import{D as B,a as P,b as T}from"./dialog-BfZLRczf.js";/* empty css            */import"./index-WK0ddop3.js";import"./createLucideIcon-BuwdUUQB.js";import"./index-DLuYWhzH.js";import"./index-PTdx2xCV.js";const H=t=>{let i;const s=new Set,n=(c,h)=>{const p=typeof c=="function"?c(i):c;if(!Object.is(p,i)){const x=i;i=h??(typeof p!="object"||p===null)?p:Object.assign({},i,p),s.forEach(f=>f(i,x))}},a=()=>i,o={setState:n,getState:a,getInitialState:()=>u,subscribe:c=>(s.add(c),()=>s.delete(c))},u=i=t(n,a,o);return o},K=t=>t?H(t):H,M=t=>t;function $(t,i=M){const s=S.useSyncExternalStore(t.subscribe,()=>i(t.getState()),()=>i(t.getInitialState()));return S.useDebugValue(s),s}const L=t=>{const i=K(t),s=n=>$(i,n);return Object.assign(s,i),s},G=t=>t?L(t):L;function W(t,i){let s;try{s=t()}catch{return}return{getItem:a=>{var r;const d=u=>u===null?null:JSON.parse(u,void 0),o=(r=s.getItem(a))!=null?r:null;return o instanceof Promise?o.then(d):d(o)},setItem:(a,r)=>s.setItem(a,JSON.stringify(r,void 0)),removeItem:a=>s.removeItem(a)}}const w=t=>i=>{try{const s=t(i);return s instanceof Promise?s:{then(n){return w(n)(s)},catch(n){return this}}}catch(s){return{then(n){return this},catch(n){return w(n)(s)}}}},X=(t,i)=>(s,n,a)=>{let r={storage:W(()=>localStorage),partialize:l=>l,version:0,merge:(l,j)=>({...j,...l}),...i},d=!1;const o=new Set,u=new Set;let c=r.storage;if(!c)return t((...l)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),s(...l)},n,a);const h=()=>{const l=r.partialize({...n()});return c.setItem(r.name,{state:l,version:r.version})},p=a.setState;a.setState=(l,j)=>{p(l,j),h()};const x=t((...l)=>{s(...l),h()},n,a);a.getInitialState=()=>x;let f;const F=()=>{var l,j;if(!c)return;d=!1,o.forEach(m=>{var g;return m((g=n())!=null?g:x)});const b=((j=r.onRehydrateStorage)==null?void 0:j.call(r,(l=n())!=null?l:x))||void 0;return w(c.getItem.bind(c))(r.name).then(m=>{if(m)if(typeof m.version=="number"&&m.version!==r.version){if(r.migrate){const g=r.migrate(m.state,m.version);return g instanceof Promise?g.then(y=>[!0,y]):[!0,g]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,m.state];return[!1,void 0]}).then(m=>{var g;const[y,k]=m;if(f=r.merge(k,(g=n())!=null?g:x),s(f,!0),y)return h()}).then(()=>{b==null||b(f,void 0),f=n(),d=!0,u.forEach(m=>m(f))}).catch(m=>{b==null||b(void 0,m)})};return a.persist={setOptions:l=>{r={...r,...l},l.storage&&(c=l.storage)},clearStorage:()=>{c==null||c.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>F(),hasHydrated:()=>d,onHydrate:l=>(o.add(l),()=>{o.delete(l)}),onFinishHydration:l=>(u.add(l),()=>{u.delete(l)})},r.skipHydration||F(),f||x},Y=X,C=G()(Y(t=>({user:null,setUser:i=>t({user:i}),clearUser:()=>t({user:null})}),{name:"user-storage"})),Z=()=>{const{user:t,setUser:i}=C(),{data:s,setData:n,processing:a,errors:r}=O({name:"",email:""}),d=o=>{o.preventDefault(),i(s)};return t?null:e.jsx("form",{className:"flex flex-col gap-6 w-1/4",onSubmit:d,children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("div",{className:"flex items-center",children:e.jsx(N,{htmlFor:"name",children:"Name"})}),e.jsx(q,{id:"name",type:"text",required:!0,tabIndex:1,autoComplete:"current-name",value:s.name,onChange:o=>n("name",o.target.value),placeholder:"Name"}),e.jsx(v,{message:r.name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"email",children:"Email address"}),e.jsx(q,{id:"email",type:"email",required:!0,autoFocus:!0,tabIndex:2,autoComplete:"email",value:s.email,onChange:o=>n("email",o.target.value),placeholder:"email@example.com"}),e.jsx(v,{message:r.email})]}),e.jsxs(I,{type:"submit",variant:"default",className:"mt-4 w-full",tabIndex:4,disabled:a,children:[a&&e.jsx(_,{className:"h-4 w-4 animate-spin"}),"Confirm"]})]})})},z=()=>{const{user:t}=C(),[i,s]=S.useState(!1),{data:n,setData:a,post:r,processing:d,errors:o}=O({message:"",email:(t==null?void 0:t.email)??"",name:(t==null?void 0:t.name)??""}),u=c=>{c.preventDefault(),r(route("queue.store"),{onSuccess:h=>{s(!1)},preserveScroll:!0})};return e.jsxs(B,{open:i,onOpenChange:s,children:[e.jsx(I,{onClick:()=>s(!0),children:"Join"}),e.jsxs(P,{children:[e.jsx(T,{children:"Add your name on queue"}),e.jsxs("form",{className:"flex flex-col gap-6",onSubmit:u,children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("div",{className:"flex items-center",children:e.jsx(N,{htmlFor:"name",children:"Request"})}),e.jsx("textarea",{id:"name",className:"mt-4 p-3 shadow-sm h-30  block w-full sm:text-sm w-full border-gray-300 rounded-md",value:n.message,onChange:c=>a("message",c.target.value),required:!0,tabIndex:1,autoComplete:"current-name",placeholder:"Message"}),o.message&&e.jsx(v,{message:o==null?void 0:o.message}),o.email&&e.jsx(v,{message:o==null?void 0:o.email}),o.name&&e.jsx(v,{message:o==null?void 0:o.name})]}),e.jsxs(I,{type:"submit",className:"mt-4 w-full",tabIndex:4,disabled:d,children:[d&&e.jsx(_,{className:"h-4 w-4 animate-spin"}),"Join"]})]})]})]})};function le({userQueues:t=[],currentUserQueueNumber:i=0}){const{user:s}=C();R(2e3,{only:["userQueues","currentUserQueueNumber"],data:{email:s==null?void 0:s.email}});const{flash:n}=U().props;return D.useEffect(()=>{var a;(a=n==null?void 0:n.message)!=null&&a.success&&E.success(n.message.success,{duration:2e3})},[n]),D.useEffect(()=>{var a;(a=n==null?void 0:n.message)!=null&&a.error&&E.error(n.message.error,{duration:2e3})},[n]),e.jsxs(e.Fragment,{children:[e.jsxs(A,{title:"Home",children:[e.jsx("link",{rel:"preconnect",href:"https://fonts.bunny.net"}),e.jsx("link",{href:"https://fonts.bunny.net/css?family=instrument-sans:400,500,600",rel:"stylesheet"})]}),e.jsx("div",{className:"flex min-h-screen flex-col gap-2 items-center justify-center  bg-[#FDFDFC] p-6 text-[#1b1b18]  lg:p-8 ",children:s!=null&&s.name?e.jsxs(e.Fragment,{children:[e.jsxs("h1",{children:["Hi ",s.name]}),i>0&&e.jsxs(e.Fragment,{children:["queue number: ",i]}),e.jsx(z,{}),e.jsx(J,{data:"userQueues",fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx("ul",{className:"w-full gap-2 grid",children:(t==null?void 0:t.length)>0&&(t==null?void 0:t.map((a,r)=>e.jsxs("li",{className:" shadow-lg border-gray-400  lg:border-gray-400 bg-white rounded-b lg:rounded-b-none lg:rounded-r p-4 flex flex-col justify-between leading-normal",children:["#",a.queue_number," ",a.name]},r)))})})]}):e.jsx(Z,{})})]})}export{le as default};
