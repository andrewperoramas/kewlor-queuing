import{U as S,m as O,j as e,g as J,K as P,r as F,V as D,L as B,A as M}from"./app-DegvsnWL.js";import{L as N,a as b,I as E}from"./label-YRqI-WM0.js";import{B as I,c as R,S as T,a as K}from"./button-DwcSvhwy.js";import{D as $,a as G,b as V}from"./dialog-DxiKq-6L.js";import{L as U}from"./loader-circle-BiDlrjWI.js";import{P as W}from"./pagination-PDjmJmxk.js";import{H}from"./heading-small-tRmpVD7O.js";/* empty css            */import"./index-CU2yUHvI.js";import"./index-BWEElcNu.js";import"./createLucideIcon-DYGVJrv5.js";import"./index-CNxj7bKY.js";const _=t=>{let n;const s=new Set,r=(c,x)=>{const u=typeof c=="function"?c(n):c;if(!Object.is(u,n)){const p=n;n=x??(typeof u!="object"||u===null)?u:Object.assign({},n,u),s.forEach(h=>h(n,p))}},o=()=>n,i={setState:r,getState:o,getInitialState:()=>g,subscribe:c=>(s.add(c),()=>s.delete(c))},g=n=t(r,o,i);return i},X=t=>t?_(t):_,Y=t=>t;function Z(t,n=Y){const s=S.useSyncExternalStore(t.subscribe,()=>n(t.getState()),()=>n(t.getInitialState()));return S.useDebugValue(s),s}const q=t=>{const n=X(t),s=r=>Z(n,r);return Object.assign(s,n),s},z=t=>t?q(t):q;function Q(t,n){let s;try{s=t()}catch{return}return{getItem:o=>{var a;const m=g=>g===null?null:JSON.parse(g,void 0),i=(a=s.getItem(o))!=null?a:null;return i instanceof Promise?i.then(m):m(i)},setItem:(o,a)=>s.setItem(o,JSON.stringify(a,void 0)),removeItem:o=>s.removeItem(o)}}const w=t=>n=>{try{const s=t(n);return s instanceof Promise?s:{then(r){return w(r)(s)},catch(r){return this}}}catch(s){return{then(r){return this},catch(r){return w(r)(s)}}}},ee=(t,n)=>(s,r,o)=>{let a={storage:Q(()=>localStorage),partialize:l=>l,version:0,merge:(l,v)=>({...v,...l}),...n},m=!1;const i=new Set,g=new Set;let c=a.storage;if(!c)return t((...l)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),s(...l)},r,o);const x=()=>{const l=a.partialize({...r()});return c.setItem(a.name,{state:l,version:a.version})},u=o.setState;o.setState=(l,v)=>{u(l,v),x()};const p=t((...l)=>{s(...l),x()},r,o);o.getInitialState=()=>p;let h;const C=()=>{var l,v;if(!c)return;m=!1,i.forEach(d=>{var f;return d((f=r())!=null?f:p)});const j=((v=a.onRehydrateStorage)==null?void 0:v.call(a,(l=r())!=null?l:p))||void 0;return w(c.getItem.bind(c))(a.name).then(d=>{if(d)if(typeof d.version=="number"&&d.version!==a.version){if(a.migrate){const f=a.migrate(d.state,d.version);return f instanceof Promise?f.then(y=>[!0,y]):[!0,f]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,d.state];return[!1,void 0]}).then(d=>{var f;const[y,A]=d;if(h=a.merge(A,(f=r())!=null?f:p),s(h,!0),y)return x()}).then(()=>{j==null||j(h,void 0),h=r(),m=!0,g.forEach(d=>d(h))}).catch(d=>{j==null||j(void 0,d)})};return o.persist={setOptions:l=>{a={...a,...l},l.storage&&(c=l.storage)},clearStorage:()=>{c==null||c.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>C(),hasHydrated:()=>m,onHydrate:l=>(i.add(l),()=>{i.delete(l)}),onFinishHydration:l=>(g.add(l),()=>{g.delete(l)})},a.skipHydration||C(),h||p},te=ee,k=z()(te(t=>({user:null,setUser:n=>t({user:n}),clearUser:()=>t({user:null})}),{name:"user-storage"})),se=()=>{const{user:t}=k(),[n,s]=S.useState(!1),{data:r,setData:o,post:a,processing:m,errors:i,reset:g,clearErrors:c}=O({message:"",email:(t==null?void 0:t.email)??"",name:(t==null?void 0:t.name)??""}),x=u=>{u.preventDefault(),a(route("queue.store"),{onSuccess:()=>{s(!1)},preserveScroll:!0}),g(),c()};return e.jsxs($,{open:n,onOpenChange:s,children:[e.jsx(I,{className:"bg-black text-white hover:bg-gray",onClick:()=>s(!0),children:"Join"}),e.jsxs(G,{className:"dark:bg-white dark:text-black",children:[e.jsx(V,{children:"Add your name on queue"}),e.jsxs("form",{className:"flex flex-col gap-6",onSubmit:x,children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("div",{className:"flex items-center",children:e.jsx(N,{htmlFor:"name",children:"Request"})}),e.jsx("textarea",{id:"name",className:"mt-4 block h-30 w-full rounded-md border-gray-300 p-3 shadow-sm sm:text-sm",value:r.message,onChange:u=>o("message",u.target.value),required:!0,tabIndex:1,autoComplete:"current-name",placeholder:"Message"}),i.message&&e.jsx(b,{message:i==null?void 0:i.message}),i.email&&e.jsx(b,{message:i==null?void 0:i.email}),i.name&&e.jsx(b,{message:i==null?void 0:i.name})]}),e.jsxs(I,{type:"submit",className:" hover:bg-gray bg-black text-white mt-4 w-full",tabIndex:4,disabled:m,children:[m&&e.jsx(U,{className:"h-4 w-4 animate-spin"}),"Join"]})]})]})]})},ae=()=>{const{user:t,setUser:n}=k(),{data:s,setData:r,processing:o,errors:a}=O({name:"",email:""}),m=i=>{i.preventDefault(),n(s)};return t?null:e.jsx("form",{className:"flex w-1/4 flex-col gap-6",onSubmit:m,children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("div",{className:"flex items-center",children:e.jsx(N,{htmlFor:"name",children:"Name"})}),e.jsx(E,{id:"name",type:"text",required:!0,tabIndex:1,autoComplete:"current-name",value:s.name,onChange:i=>r("name",i.target.value),placeholder:"Name"}),e.jsx(b,{message:a.name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"email",children:"Email address"}),e.jsx(E,{id:"email",type:"email",required:!0,autoFocus:!0,tabIndex:2,autoComplete:"email",value:s.email,onChange:i=>r("email",i.target.value),placeholder:"email@example.com"}),e.jsx(b,{message:a.email})]}),e.jsxs(I,{type:"submit",variant:"default",className:"mt-4 w-full",tabIndex:4,disabled:o,children:[o&&e.jsx(U,{className:"h-4 w-4 animate-spin"}),"Confirm"]})]})})};function re({className:t,...n}){return e.jsx("div",{"data-slot":"card",className:R("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...n})}const ne=K("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-auto",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function L({className:t,variant:n,asChild:s=!1,...r}){const o=s?T:"span";return e.jsx(o,{"data-slot":"badge",className:R(ne({variant:n}),t),...r})}function ve({userQueues:t,currentUserQueueNumber:n=0}){var o;const{user:s}=k();J(2e3,{only:["userQueues","currentUserQueueNumber"],data:{email:s==null?void 0:s.email}});const{flash:r}=P().props;return F.useEffect(()=>{var a;(a=r==null?void 0:r.message)!=null&&a.success&&D.success(r.message.success,{duration:2e3})},[r]),F.useEffect(()=>{var a;(a=r==null?void 0:r.message)!=null&&a.error&&D.error(r.message.error,{duration:2e3})},[r]),e.jsxs(e.Fragment,{children:[e.jsxs(B,{title:"Home",children:[e.jsx("link",{rel:"preconnect",href:"https://fonts.bunny.net"}),e.jsx("link",{href:"https://fonts.bunny.net/css?family=instrument-sans:400,500,600",rel:"stylesheet"})]}),e.jsx("div",{className:"flex min-h-screen flex-col items-center justify-center gap-2 bg-[#FDFDFC] p-6 text-[#1b1b18] lg:p-8",children:s!=null&&s.name?e.jsxs(e.Fragment,{children:[e.jsxs("h1",{children:["Hi ",s.name]}),n>0&&e.jsxs(e.Fragment,{children:["queue number: ",n]}),e.jsx(se,{}),e.jsx(M,{data:"userQueues",fallback:e.jsx("div",{className:"h-[800px] w-full block"}),children:e.jsxs(e.Fragment,{children:[e.jsx("ul",{className:"my-4 grid w-1/3 gap-4",children:((o=t==null?void 0:t.data)==null?void 0:o.length)>0&&(t==null?void 0:t.data.map((a,m)=>e.jsxs(re,{children:[e.jsxs("div",{className:"pl-4 flex",children:[a.queue_number!==0?e.jsxs(L,{className:"mr-2",children:[" #",a.queue_number," "]}):e.jsx(L,{className:"mr-2",variant:"destructive",children:" completed "}),a.name]}),e.jsx("hr",{}),a.admin_notes&&e.jsx("div",{className:"pl-4",children:e.jsx(H,{title:"Notes",description:a.admin_notes})}),a.message&&e.jsx("div",{className:"pl-4",children:e.jsx(H,{title:"Message:",description:a.message})})]},m)))}),e.jsx(W,{links:t==null?void 0:t.links})]})})]}):e.jsx(ae,{})})]})}export{ve as default};
